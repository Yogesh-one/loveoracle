<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Love Oracle ğŸ”®</title>
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
  <!-- html2canvas library for snapshot functionality -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    :root {
      --gradient-angle: -45deg;
    }
    body {
      font-family: 'Great Vibes', cursive;
      text-align: center;
      /* Animated gradient: pink, violet, blue */
      background: linear-gradient(var(--gradient-angle), #ff6b6b, #ff8e8e, #ffb3b3, #d291ff, #8e8eff);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      min-height: 100vh;
      margin: 0;
      overflow: hidden;
      position: relative;
      color: #4a4a4a;
    }
    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    /* Floating hearts, emoji rain, and fireworks */
    .hearts, .emoji-rain, .fireworks {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    .heart, .emoji {
      position: absolute;
      animation: float 8s linear infinite;
      opacity: 0;
    }
    @keyframes float {
      0% { transform: translateY(110vh) rotate(0deg); opacity: 1; }
      100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
    }
    /* Container and message box */
    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
      position: relative;
      z-index: 1;
    }
    .message-box {
      background: rgba(255, 255, 255, 0.95);
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 0 30px rgba(255, 65, 129, 0.3);
      margin: 20px;
      animation: fadeIn 1s;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    input {
      padding: 12px;
      margin: 15px;
      border: 3px solid #ff4081;
      border-radius: 25px;
      font-size: 18px;
      width: 80%;
      max-width: 200px;
      transition: transform 0.3s;
    }
    input:focus {
      transform: scale(1.05);
      outline: none;
    }
    button {
      background: #ff4081;
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 25px;
      font-size: 18px;
      cursor: pointer;
      transition: transform 0.3s;
      margin: 10px;
    }
    button:hover {
      transform: scale(1.1) rotate(3deg);
    }
    /* Compatibility meter */
    .compatibility-meter {
      width: 80%;
      height: 30px;
      background: #ffe6e6;
      border-radius: 15px;
      margin: 20px auto;
      overflow: hidden;
    }
    .progress {
      height: 100%;
      background: linear-gradient(90deg, #ff6b6b, #ff4081);
      transition: width 2s ease-in-out;
    }
    /* Fireworks and pulse animations */
    .fireworks {
      top: 0;
      left: 0;
      z-index: 2;
    }
    .firework {
      position: absolute;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      animation: explode 1s ease-out;
    }
    @keyframes explode {
      0% { transform: scale(1); opacity: 1; }
      100% { transform: scale(10); opacity: 0; }
    }
    .pulse {
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    .disclaimer {
      font-size: 12px;
      opacity: 0.7;
      margin-top: 20px;
    }
    /* Watermark (always visible on page) */
    .watermark {
      position: fixed;
      bottom: 10px;
      right: 10px;
      font-size: 14px;
      opacity: 0.6;
    }
    /* Snapshot card for sharing â€“ only shown when triggered */
    .snapshot-card {
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 20px;
      box-shadow: 0 0 30px rgba(255, 65, 129, 0.3);
      margin: 20px auto;
      max-width: 400px;
      display: none;
    }
    .snapshot-card h2 {
      margin-top: 0;
    }
    .snapshot-card img {
      width: 100%;
      border-radius: 10px;
    }
    @media (max-width: 600px) {
      input { width: 80%!important; }
      button { padding: 12px 24px; }
      .message-box { margin: 10px; padding: 20px; }
    }
  </style>
</head>
<body>
  <!-- Floating animations -->
  <div class="hearts" id="hearts"></div>
  <div class="emoji-rain" id="emojiRain"></div>
  <div class="fireworks" id="fireworks"></div>
  
  <div class="container">
    <!-- Main Input Area -->
    <div class="message-box" id="main-content">
      <h1 style="font-size: 2.5em; margin: 0;">ğŸ”® Cosmic Cupid's Playground ğŸ’˜</h1>
      <p style="font-size: 1.2em;">Where Algorithms Meet Romance... Sort Of</p>
      
      <input type="text" id="userName" placeholder="Your Name">
      <input type="text" id="crushName" placeholder="Crush's Name">
      <br>
      <button onclick="calculateCompatibility()">ğŸŒŒ Launch Love Radar ğŸŒŒ</button>
      <button onclick="showSingleFortune()">ğŸª Lonely Hearts Club ğŸª</button>
    </div>

    <!-- Result Area -->
    <div id="result-container" class="message-box" style="display: none;">
      <div id="result-content"></div>
      <button onclick="location.reload()">ğŸ”„ Spin Again ğŸ”„</button>
      <!-- "Add to Story" button -->
      <button onclick="shareResult()">ğŸ“¢ Add to Story ğŸ“¢</button>
      <p class="disclaimer">âš ï¸ Disclaimer: This cosmic match is just a fun projection by unicorns & stardust. Not scientifically proven! ğŸ¦„</p>
    </div>
  </div>

  <!-- Watermark -->
  <div class="watermark">curated with love by Yogesh ğŸ’–</div>

  <!-- Snapshot Card (for sharing snapshot) -->
  <div class="snapshot-card" id="snapshotCard">
    <h2>Your Cosmic Love Snapshot ğŸŒŒ</h2>
    <div id="snapshotContent"></div>
    <!-- The download button will be hidden during snapshot capture -->
    <button id="downloadBtn" onclick="downloadSnapshot()">ğŸ“¥ Download Snapshot</button>
  </div>

  <script>
    // ====================== CORE FUNCTIONALITY ======================
    // Create floating hearts
    function createHearts() {
      const heartsContainer = document.getElementById('hearts');
      for (let i = 0; i < 20; i++) {
        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.style.left = Math.random() * 100 + '%';
        heart.style.animationDelay = Math.random() * 5 + 's';
        heart.innerHTML = 'â¤';
        heartsContainer.appendChild(heart);
      }
    }
    createHearts();

    // ====================== LOVE CALCULATION ENGINE ======================
    function calculateCompatibility() {
      const userName = document.getElementById('userName').value.trim() || "";
      const crushName = document.getElementById('crushName').value.trim() || "";

      // If one or both fields are empty, show a humorous prompt
      if (!userName || !crushName) {
        showResult(`
          <h2>ğŸ¤” Oops! Did you forget something?</h2>
          <p>Either your name or your crush's name is missing. Maybe you're too shy or lost in daydreams? ğŸ˜</p>
          <div style="font-size: 40px">ğŸ•µï¸â€â™‚ï¸</div>
          ${createEmojiRain('ğŸ˜…ğŸ¤·â€â™‚ï¸', 20)}
        `);
        return;
      }

      // Edge case: Narcissism detector (same name)
      if (userName.toLowerCase() === crushName.toLowerCase()) {
        showResult(`
          <div class="pulse">ğŸ’–</div>
          <h2>${userName} & ${userName}</h2>
          <div class="compatibility-meter">
            <div class="progress" style="width: 100%"></div>
          </div>
          <h3>200% Cosmic Self-Love!</h3>
          <p>ğŸ† Wow! You've won the Self-Love Olympics. Who needs a crush when you're this awesome?</p>
          <p>ğŸµ Anthem: "I'm My Own Soulmate" ğŸ¶</p>
          ${createEmojiRain('ğŸ’â€â™‚ï¸ğŸ’…ğŸ‘‘', 30)}
        `);
        addFireworks('ğŸŒˆ');
        return;
      }

      // Deterministic calculation using names
      const loveHash = (userName + crushName).split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
      const percentage = Math.abs(loveHash) % 101;
      const emojiTheme = getEmojiTheme(percentage);

      showResult(`
        ${createEmojiRain(emojiTheme.symbols, emojiTheme.count)}
        <h2>${userName} & ${crushName}</h2>
        <div class="compatibility-meter">
          <div class="progress" style="width: ${percentage}%"></div>
        </div>
        <h3>${percentage}% Cosmic Connection</h3>
        <p>${getCompatibilityMessage(percentage)}</p>
        ${percentage >= 90 ? "<div class='pulse'>ğŸ‰</div><p>ğŸš¨ ALERT: Love so intense it might just lead to a wedding! ğŸ’</p>" : ""}
        ${createStarRating(percentage)}
        ${getExtraReward(percentage)}
      `);

      // Add extra animations based on percentage
      if (percentage >= 90) {
        addFireworks('âœ¨');
        setTimeout(() => addFireworks('ğŸ‡'), 500);
      } else {
        addConfetti();
      }
    }

    // ====================== SINGLE'S FORTUNE MODE ======================
    function showSingleFortune() {
      const fortunes = [
        "ğŸ¾ Adopt ALL the cats. Become the Crazy Cat Royalty of your neighborhood!",
        "ğŸ• Date Yourself! After all, pizza never judges you.",
        "ğŸ® Virtual Love > Real Drama â€“ Level Up your single life!",
        "ğŸ’¸ Silver Lining: No annoying in-laws to crash your vibe!",
        "ğŸ›Œ Embrace the Bed Hog Life â€“ your comfort is a priority!",
        "ğŸš« No-Sharing Chocolate Policy: Strictly enforced!"
      ];
      showResult(`
        ${createEmojiRain('ğŸ˜ğŸ·ğŸ“šğŸ§', 25)}
        <h2>âœ¨ Single & Spectacular Forecast âœ¨</h2>
        <p>${fortunes[Math.floor(Math.random() * fortunes.length)]}</p>
        <div style="font-size: 40px">${['ğŸ¦„', 'ğŸŒŸ', 'ğŸª', 'ğŸ®'][Math.floor(Math.random()*4)]}</div>
        <p>ğŸ”® Your cosmic vibe today: "${['Netflix Marathon', 'Spa Day Extravaganza', 'Cheesecake Heist'][Math.floor(Math.random()*3)]}"</p>
      `);
      addConfetti();
    }

    // ====================== SNAPSHOT / SHARE FUNCTIONALITY ======================
    // When the user clicks "Add to Story," show the snapshot card.
    function shareResult() {
      const snapshotCard = document.getElementById('snapshotCard');
      const snapshotContent = document.getElementById('snapshotContent');
      // Copy the result content into the snapshot card.
      snapshotContent.innerHTML = document.getElementById('result-content').innerHTML;
      snapshotCard.style.display = 'block';
    }
    // Download the snapshot as an image; temporarily hide the download button.
    function downloadSnapshot() {
      const snapshotCard = document.getElementById('snapshotCard');
      const downloadBtn = document.getElementById('downloadBtn');
      // Hide the download button so it doesn't appear in the snapshot.
      downloadBtn.style.display = 'none';
      html2canvas(snapshotCard).then(canvas => {
        const link = document.createElement('a');
        link.download = 'love-oracle-snapshot.png';
        link.href = canvas.toDataURL("image/png");
        link.click();
        // Restore the download button after snapshot is taken.
        downloadBtn.style.display = 'block';
      });
    }

    // ====================== UTILITY FUNCTIONS ======================
    function getEmojiTheme(percentage) {
      return percentage >= 90 ? { symbols: 'ğŸ’˜ğŸŒŸğŸ‰ğŸ’ğŸ‘°', count: 40 } :
             percentage >= 70 ? { symbols: 'ğŸ’–ğŸ€ğŸ’ğŸ¥‚', count: 25 } :
             percentage >= 50 ? { symbols: 'ğŸ’•ğŸŒ¹âœ¨ğŸ¤', count: 15 } :
             percentage >= 30 ? { symbols: 'ğŸ’”â˜”ğŸŒ§ï¸ğŸš¬', count: 10 } :
             { symbols: 'ğŸ’€â˜ ï¸ğŸ‘»ğŸš«', count: 20 };
    }

    function createStarRating(percentage) {
      const stars = 'â˜…'.repeat(Math.floor(percentage/20)) + 'â˜†'.repeat(5 - Math.floor(percentage/20));
      return `<div style="font-size: 30px; color: #ffd700">${stars}</div>`;
    }

    function getExtraReward(percentage) {
      return percentage >= 90 ? "<p>ğŸ Bonus: A virtual shower of confetti and cosmic high-fives! ğŸ‰</p>" :
             percentage >= 70 ? "<p>ğŸˆ Achievement Unlocked: 'Hopeful Romantic' Badge! ğŸ…</p>" : "";
    }

    // Unique humorous messages for compatibility tiers
    function getCompatibilityMessage(percentage) {
      let messages;
      if (percentage >= 90) {
        messages = ["ğŸ’¥ You're a rom-com in motion!", "ğŸš€ Love rocket activated!", "ğŸ¤¯ Mind-blowing chemistry detected!"];
      } else if (percentage >= 70) {
        messages = ["ğŸ”¥ Sparks are flying!", "ğŸ¯ Cupid's arrow almost hit the bullseye!", "ğŸ§² Magnetic attraction in progress!"];
      } else if (percentage >= 50) {
        messages = ["ğŸ¢ Relationship rollercoaster ahead!", "ğŸ¤·â€â™€ï¸ Could go either way...", "ğŸ’¼ Keep that day job just in case."];
      } else if (percentage >= 30) {
        messages = ["ğŸ¤” 'It's complicated' is loading...", "ğŸ­ Drama level: Shakespearean!", "ğŸ· Wine & cry package recommended."];
      } else if (percentage >= 10) {
        messages = ["ğŸ‘» Ghosting probability: 99%!", "ğŸ§Š Certified cold shoulder specialist!", "ğŸš« Romance not found (404 error)."];
      } else {
        messages = ["ğŸ’” Nuclear rejection zone!", "â˜ ï¸ Better luck in the next life!", "ğŸª¦ RIP your love life."];
      }
      return messages[Math.floor(Math.random() * messages.length)] + " " + getEmojiTheme(percentage).symbols;
    }

    // Show the result content and hide the main input area.
    function showResult(content) {
      document.getElementById('main-content').style.display = 'none';
      document.getElementById('result-container').style.display = 'block';
      document.getElementById('result-content').innerHTML = content;
    }

    // Create emoji rain effect on the background.
    function createEmojiRain(symbols, count) {
      const container = document.getElementById('emojiRain');
      container.innerHTML = '';
      for (let i = 0; i < count; i++) {
        const emoji = document.createElement('div');
        emoji.className = 'emoji';
        emoji.style.left = Math.random() * 100 + '%';
        emoji.style.animationDelay = Math.random() * 2 + 's';
        emoji.style.fontSize = Math.random() * 20 + 15 + 'px';
        emoji.innerHTML = symbols[Math.floor(Math.random() * symbols.length)];
        container.appendChild(emoji);
      }
      return '';
    }

    // Add confetti falling from the top.
    function addConfetti() {
      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.style.position = 'fixed';
        confetti.style.backgroundColor = `hsl(${Math.random() * 360}deg, 100%, 50%)`;
        confetti.style.left = Math.random() * 100 + 'vw';
        confetti.style.top = '-10px';
        confetti.style.width = '8px';
        confetti.style.height = '8px';
        confetti.style.borderRadius = '50%';
        confetti.style.animation = `fall ${Math.random() * 3 + 2}s linear`;
        document.body.appendChild(confetti);
        setTimeout(() => confetti.remove(), 5000);
      }
    }

    // Add fireworks animation at random positions.
    function addFireworks(emoji) {
      const container = document.getElementById('fireworks');
      for (let i = 0; i < 15; i++) {
        const firework = document.createElement('div');
        firework.className = 'firework';
        firework.style.left = Math.random() * 100 + 'vw';
        firework.style.top = Math.random() * 100 + 'vh';
        firework.style.color = `hsl(${Math.random() * 360}deg, 100%, 50%)`;
        firework.innerHTML = emoji || 'âœ¨';
        firework.style.fontSize = '30px';
        container.appendChild(firework);
        setTimeout(() => firework.remove(), 1000);
      }
    }
  </script>
</body>
</html>
